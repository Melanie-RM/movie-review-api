{% extends 'base.html' %}

{% block title %}{{ movie.title }} - Movie Review{% endblock %}

{% block content %}
<div class="flex flex-col md:flex-row gap-6">
    <img src="https://image.tmdb.org/t/p/w500{{ movie.poster_path }}" alt="{{ movie.title }}" class="w-full md:w-1/3 rounded">
    
    <div class="md:w-2/3">
        <h1 class="text-3xl font-bold">{{ movie.title }}</h1>
        <p class="text-gray-700 mt-2">{{ movie.overview }}</p>
        <p class="mt-2 text-gray-500">Release Date: {{ movie.release_date }}</p>

        <h2 class="text-2xl mt-4 font-semibold">Reviews</h2>
        <div class="mt-2">
            {% for review in reviews %}
                <div class="border p-2 rounded mb-2">
                    <strong>{{ review.user.username }}</strong> - {{ review.rating }} ⭐
                    <p>{{ review.comment }}</p>
                    <form method="POST" action="{% url 'like_review' review.id %}">
                        {% csrf_token %}
                        <button type="submit" class="text-red-500 hover:underline">❤️ {{ review.likes.count }}</button>
                    </form>
                </div>
            {% empty %}
                <p>No reviews yet. Be the first to review!</p>
            {% endfor %}
        </div>

        <h3 class="text-xl mt-4 font-semibold">Add Your Review</h3>
        <form method="POST" action="{% url 'add_review' movie.id %}" class="mt-2">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Submit</button>
        </form>
    </div>
</div>
{% endblock %}